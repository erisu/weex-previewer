#!/usr/bin/env node

const fs = require('fs');
const yargs = require('yargs');
const preview = require('../build/index');

const userinfo = '\nUsage: weex-previewer <foo/bar/we_file_or_dir_path>  [options]';
const argv = yargs
  .usage(userinfo)
  .option('port', {
    demand: false
  })
  .default('port', 8081)
  .describe('port', 'http listening port number ,default is 8081')
  .option('wsport', {
    demand: false
  })
  .default('wsport', 8082)
  .describe('wsport', 'websocket listening port number ,default is 8082')
  .describe('entry', 'the entry file in a folder')
  .epilog('Usage:weex-previewer demo/index.vue --port 8087')
  .argv;

const inputPath = argv._[0];
let badWePath = !!(!inputPath || (inputPath.length < 2));
try {
  fs.accessSync(inputPath, fs.F_OK);
} catch (e) {
  badWePath = true;
}
if (badWePath) {
  yargs.showHelp();
  process.exit(1);
}

preview(argv);
